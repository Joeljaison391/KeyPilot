<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KeyPilot API Gateway - Complete Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        }
        
        .nav {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .logo {
            font-size: 2em;
            font-weight: bold;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .nav-links {
            display: flex;
            gap: 20px;
        }
        
        .nav-link {
            color: #333;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            background: #667eea;
            color: white;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        .hero {
            text-align: center;
            color: white;
            margin-bottom: 60px;
        }
        
        .hero h1 {
            font-size: 3em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .hero p {
            font-size: 1.2em;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .content {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .section {
            margin-bottom: 50px;
        }
        
        .section-title {
            font-size: 2em;
            color: #2c3e50;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .route-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            margin-bottom: 30px;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .route-card:hover {
            box-shadow: 0 5px 25px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .route-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .route-method {
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .route-url {
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            flex-grow: 1;
            margin: 0 20px;
        }
        
        .route-body {
            padding: 25px;
        }
        
        .route-description {
            color: #666;
            margin-bottom: 20px;
            font-size: 1.1em;
        }
        
        .subsection {
            margin-bottom: 25px;
        }
        
        .subsection-title {
            font-size: 1.2em;
            color: #34495e;
            margin-bottom: 15px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .code-container {
            position: relative;
            background: #2c3e50;
            border-radius: 8px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .code-header {
            background: #34495e;
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9em;
            color: #ecf0f1;
        }
        
        .copy-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 5px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.3s ease;
        }
        
        .copy-btn:hover {
            background: #5a6fd8;
            transform: scale(1.05);
        }
        
        .copy-btn.copied {
            background: #27ae60;
        }
        
        .code-content {
            padding: 20px;
            color: #ecf0f1;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.5;
            white-space: pre-wrap;
            overflow-x: auto;
        }
        
        .response-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }
        
        .success-response {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .error-response {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .response-header {
            padding: 10px 15px;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .success-response .response-header {
            background: #c3e6cb;
            color: #155724;
        }
        
        .error-response .response-header {
            background: #f5c6cb;
            color: #721c24;
        }
        
        .response-content {
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            background: white;
            border-radius: 0 0 8px 8px;
        }
        
        .flow-step {
            background: #e8f4fd;
            border-left: 4px solid #667eea;
            padding: 15px 20px;
            margin: 10px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .flow-step-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .badge {
            background: #667eea;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            margin-right: 5px;
        }
        
        .auth-required {
            background: #f39c12;
        }
        
        .development-only {
            background: #e74c3c;
        }
        
        .table-container {
            overflow-x: auto;
            margin: 15px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        
        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }
        
        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .template-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .template-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .template-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .template-name {
            font-weight: bold;
            color: #2c3e50;
            font-size: 1.1em;
        }
        
        .provider-badge {
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.85em;
        }
        
        @media (max-width: 768px) {
            .response-container {
                grid-template-columns: 1fr;
            }
            
            .nav {
                flex-direction: column;
                gap: 15px;
            }
            
            .hero h1 {
                font-size: 2em;
            }
            
            .route-header {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
        }
        
        /* Redis Features Styling */
        .redis-feature-highlight {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }
        
        .redis-performance-metric {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        
        .metric-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #e74c3c;
            transition: all 0.3s ease;
        }
        
        .metric-card:hover {
            background: #e74c3c;
            color: white;
            transform: scale(1.05);
        }
        
        .metric-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #e74c3c;
        }
        
        .metric-card:hover .metric-value {
            color: white;
        }
        
        .redis-data-structure {
            background: linear-gradient(90deg, #fff5f5, #fed7d7);
            border-left: 4px solid #e74c3c;
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .redis-benefit-list {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }
        
        .redis-benefit-item {
            background: rgba(231, 76, 60, 0.1);
            padding: 10px;
            border-radius: 5px;
            border-left: 3px solid #e74c3c;
        }
        
        /* Analytics Section Styling */
        .analytics-badge {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            margin-left: 10px;
        }
        
        .trend-insight {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="logo">🔑 KeyPilot</div>
            <div class="nav-links">
                <a href="#authentication" class="nav-link">Authentication</a>
                <a href="#api-keys" class="nav-link">API Keys</a>
                <a href="#proxy" class="nav-link">Proxy</a>
                <a href="#analytics" class="nav-link">Analytics</a>
                <a href="#templates" class="nav-link">Templates</a>
                <a href="#redis-features" class="nav-link">Redis Features</a>
            </div>
        </nav>
    </header>

    <div class="container">
        <div class="hero">
            <h1>🚀 KeyPilot API Gateway</h1>
            <p>Complete API Documentation with Testing Examples, Sample Requests, and Response Models</p>
        </div>

        <div class="content">
            <!-- Authentication Routes -->
            <section id="authentication" class="section">
                <h2 class="section-title">
                    🔐 Authentication Routes
                </h2>

                <!-- Login Route -->
                <div class="route-card">
                    <div class="route-header">
                        <span class="route-method">POST</span>
                        <span class="route-url">/auth/login</span>
                        <span class="badge">Public</span>
                    </div>
                    <div class="route-body">
                        <p class="route-description">
                            Authenticate a user and receive a session token valid for 30 minutes.
                        </p>

                        <div class="subsection">
                            <h4 class="subsection-title">🔄 User Flow</h4>
                            <div class="flow-step">
                                <div class="flow-step-title">1. User provides credentials</div>
                                Submit userId and password
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">2. System validates user</div>
                                Check against demo users or user database
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">3. Session created</div>
                                Generate 30-minute session token stored in Redis
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">4. Token returned</div>
                                Client receives token for API requests
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📋 Request Body</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>JSON Request</span>
                                    <button class="copy-btn" onclick="copyToClipboard('login-request')">Copy</button>
                                </div>
                                <div class="code-content" id="login-request">{
  "userId": "demo3",
  "password": "pass3"
}</div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📤 Response Examples</h4>
                            <div class="response-container">
                                <div class="success-response">
                                    <div class="response-header">✅ Success Response (200)</div>
                                    <div class="response-content">{
  "success": true,
  "token": "eca8d79e7cf3494f"
}</div>
                                </div>
                                <div class="error-response">
                                    <div class="response-header">❌ Error Response (401)</div>
                                    <div class="response-content">{
  "success": false,
  "error": "Invalid credentials",
  "message": "User not found or invalid credentials"
}</div>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">🧪 cURL Test Command</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>cURL</span>
                                    <button class="copy-btn" onclick="copyToClipboard('login-curl')">Copy</button>
                                </div>
                                <div class="code-content" id="login-curl">curl -X POST "http://localhost:3000/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "userId": "demo3",
    "password": "pass3"
  }'</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Session TTL Warning -->
                <div class="route-card" style="border-left: 4px solid #ff6b6b;">
                    <div class="route-header" style="background: linear-gradient(135deg, #ff6b6b, #ffa726);">
                        <span class="route-method" style="background: #ff5722;">⚠️</span>
                        <span class="route-url">Session & API Key Expiry</span>
                        <span class="badge" style="background: #ff5722;">Important</span>
                    </div>
                    <div class="route-body">
                        <p class="route-description">
                            <strong>Automatic Cleanup:</strong> When your session expires (30 minutes), ALL your API keys are automatically deleted for security.
                        </p>

                        <div class="subsection">
                            <h4 class="subsection-title">🔄 Automatic Cleanup Behavior</h4>
                            <div class="flow-step">
                                <div class="flow-step-title">⏰ Session TTL: 30 minutes</div>
                                Your authentication token expires after 30 minutes of inactivity
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">🗑️ API Key Cleanup</div>
                                When session expires, ALL your stored API keys are automatically deleted
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">🔄 Re-login Required</div>
                                You must login again and re-add your API keys to continue using the service
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">🔒 Security Benefit</div>
                                Prevents abandoned sessions from retaining sensitive API credentials
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">💡 Best Practices</h4>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0;">
                                <ul style="margin: 0; padding-left: 20px;">
                                    <li><strong>Active Usage:</strong> Keep making API calls to maintain session</li>
                                    <li><strong>Re-authentication:</strong> Be prepared to login and reconfigure API keys</li>
                                    <li><strong>Automation:</strong> Implement automatic re-login in your applications</li>
                                    <li><strong>Security:</strong> This ensures your API keys don't persist indefinitely</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Add API Key Route -->
                <div class="route-card">
                    <div class="route-header">
                        <span class="route-method">POST</span>
                        <span class="route-url">/auth/add-key</span>
                        <span class="badge auth-required">Token Required</span>
                    </div>
                    <div class="route-body">
                        <p class="route-description">
                            Add a new API key with encryption, semantic conflict detection, and comprehensive validation.
                        </p>

                        <div class="subsection">
                            <h4 class="subsection-title">🔄 User Flow</h4>
                            <div class="flow-step">
                                <div class="flow-step-title">1. Token Validation</div>
                                Verify user session token is valid and active
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">2. Template Conflict Check</div>
                                Prevent duplicate templates for the same user
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">3. Semantic Analysis</div>
                                Check for similar descriptions using vector similarity
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">4. Encryption & Storage</div>
                                Encrypt API key with AES-256-CTR and store with metadata
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📋 Request Body</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>JSON Request</span>
                                    <button class="copy-btn" onclick="copyToClipboard('add-key-request')">Copy</button>
                                </div>
                                <div class="code-content" id="add-key-request">{
  "token": "eca8d79e7cf3494f",
  "api_key": "sk-your-real-api-key-here",
  "description": "OpenAI GPT-4 for advanced text generation and analysis",
  "template": "gpt4-advanced",
  "max_requests_per_day": 500,
  "max_requests_per_week": 2000,
  "max_tokens_per_day": 50000,
  "max_payload_kb": 1000,
  "expiry_date": "2025-12-31T23:59:59Z",
  "allowed_origins": ["https://myapp.com", "https://staging.myapp.com"],
  "scopes": ["text", "completion", "analysis", "gpt4"]
}</div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📤 Response Examples</h4>
                            <div class="response-container">
                                <div class="success-response">
                                    <div class="response-header">✅ Success Response (201)</div>
                                    <div class="response-content">{
  "success": true,
  "message": "API key added successfully",
  "template": "gpt4-advanced",
  "userId": "demo3",
  "keyId": "user:demo3:keys:gpt4-advanced",
  "metadata": {
    "created_at": "2025-07-27T15:30:00.000Z",
    "encrypted": true,
    "scopes": ["text", "completion", "analysis", "gpt4"]
  }
}</div>
                                </div>
                                <div class="error-response">
                                    <div class="response-header">❌ Error Response (409)</div>
                                    <div class="response-content">{
  "success": false,
  "error": "Semantic conflict detected",
  "details": {
    "similar_templates": [
      {
        "template": "existing-gpt-template",
        "similarity": 0.945,
        "description": "OpenAI GPT for text generation"
      }
    ],
    "threshold": 0.9
  }
}</div>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">🧪 cURL Test Command</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>cURL</span>
                                    <button class="copy-btn" onclick="copyToClipboard('add-key-curl')">Copy</button>
                                </div>
                                <div class="code-content" id="add-key-curl">curl -X POST "http://localhost:3000/auth/add-key" \
  -H "Content-Type: application/json" \
  -d '{
    "token": "eca8d79e7cf3494f",
    "api_key": "sk-your-real-api-key-here",
    "description": "OpenAI GPT-4 for advanced text generation",
    "template": "gpt4-advanced",
    "max_requests_per_day": 500,
    "scopes": ["text", "completion", "gpt4"]
  }'</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Demo Users Route -->
                <div class="route-card">
                    <div class="route-header">
                        <span class="route-method">GET</span>
                        <span class="route-url">/auth/demo-users</span>
                        <span class="badge development-only">Development Only</span>
                    </div>
                    <div class="route-body">
                        <p class="route-description">
                            Get a list of available demo users for testing purposes.
                        </p>

                        <div class="subsection">
                            <h4 class="subsection-title">📤 Response Examples</h4>
                            <div class="response-container">
                                <div class="success-response">
                                    <div class="response-header">✅ Success Response (200)</div>
                                    <div class="response-content">{
  "success": true,
  "demoUsers": [
    {"userId": "demo1", "passwordHint": "pa***"},
    {"userId": "demo2", "passwordHint": "pa***"},
    {"userId": "demo3", "passwordHint": "pa***"}
  ],
  "totalUsers": 3
}</div>
                                </div>
                                <div class="error-response">
                                    <div class="response-header">❌ Error Response (403)</div>
                                    <div class="response-content">{
  "success": false,
  "error": "Endpoint only available in development mode"
}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Update API Key Route -->
                <div class="route-card">
                    <div class="route-header">
                        <span class="route-method">PUT</span>
                        <span class="route-url">/auth/update-key</span>
                        <span class="badge auth-required">Token Required</span>
                    </div>
                    <div class="route-body">
                        <p class="route-description">
                            Update existing API key settings including limits, scopes, and expiry date.
                        </p>

                        <div class="subsection">
                            <h4 class="subsection-title">🔄 User Flow</h4>
                            <div class="flow-step">
                                <div class="flow-step-title">1. Token Validation</div>
                                Verify user session token and extract userId
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">2. Template Existence Check</div>
                                Ensure the API key template exists for the user
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">3. Semantic Conflict Detection</div>
                                Check for description conflicts if description is updated
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">4. Update & Store</div>
                                Update only provided fields and save to Redis
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📋 Request Body</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>JSON Request</span>
                                    <button class="copy-btn" onclick="copyToClipboard('update-key-request')">Copy</button>
                                </div>
                                <div class="code-content" id="update-key-request">{
  "token": "eca8d79e7cf3494f",
  "template": "text-gpt-completion",
  "description": "Updated OpenAI GPT-4 for advanced text generation",
  "max_requests_per_day": 750,
  "max_requests_per_week": 3000,
  "max_tokens_per_day": 75000,
  "expiry_date": "2025-12-31T23:59:59Z",
  "allowed_origins": ["https://myapp.com", "https://staging.myapp.com", "https://test.myapp.com"],
  "scopes": ["text", "completion", "analysis", "gpt4", "advanced"]
}</div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📤 Response Examples</h4>
                            <div class="response-container">
                                <div class="success-response">
                                    <div class="response-header">✅ Success Response (200)</div>
                                    <div class="response-content">{
  "success": true,
  "message": "API key updated successfully",
  "template": "text-gpt-completion",
  "updated_fields": [
    "description", "max_requests_per_day", 
    "max_requests_per_week", "max_tokens_per_day", 
    "expiry_date", "allowed_origins", "scopes"
  ],
  "limits": {
    "max_requests_per_day": 750,
    "max_requests_per_week": 3000,
    "max_tokens_per_day": 75000,
    "max_payload_kb": 1000
  },
  "last_modified": "2025-07-27T15:45:00.000Z"
}</div>
                                </div>
                                <div class="error-response">
                                    <div class="response-header">❌ Error Response (404)</div>
                                    <div class="response-content">{
  "success": false,
  "error": "API key not found",
  "message": "No API key with template 'invalid-template' found for this user"
}</div>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">🧪 cURL Test Command</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>cURL</span>
                                    <button class="copy-btn" onclick="copyToClipboard('update-key-curl')">Copy</button>
                                </div>
                                <div class="code-content" id="update-key-curl">curl -X PUT "http://localhost:3000/auth/update-key" \
  -H "Content-Type: application/json" \
  -d '{
    "token": "eca8d79e7cf3494f",
    "template": "text-gpt-completion",
    "max_requests_per_day": 750,
    "scopes": ["text", "completion", "advanced"]
  }'</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Delete API Key Route -->
                <div class="route-card">
                    <div class="route-header">
                        <span class="route-method">DELETE</span>
                        <span class="route-url">/auth/delete-key</span>
                        <span class="badge auth-required">Token Required</span>
                    </div>
                    <div class="route-body">
                        <p class="route-description">
                            Permanently delete an API key from user's profile with confirmation requirement.
                        </p>

                        <div class="subsection">
                            <h4 class="subsection-title">🔄 User Flow</h4>
                            <div class="flow-step">
                                <div class="flow-step-title">1. Token Validation</div>
                                Verify user session token and extract userId
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">2. Key Existence Check</div>
                                Ensure the API key template exists for deletion
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">3. Confirmation Required</div>
                                Require explicit confirmation for safety
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">4. Permanent Deletion</div>
                                Remove key from Redis and return final usage stats
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📋 Request Body</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>JSON Request</span>
                                    <button class="copy-btn" onclick="copyToClipboard('delete-key-request')">Copy</button>
                                </div>
                                <div class="code-content" id="delete-key-request">{
  "token": "eca8d79e7cf3494f",
  "template": "text-gpt-completion",
  "confirm": true
}</div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📤 Response Examples</h4>
                            <div class="response-container">
                                <div class="success-response">
                                    <div class="response-header">✅ Success Response (200)</div>
                                    <div class="response-content">{
  "success": true,
  "message": "API key deleted successfully",
  "template": "text-gpt-completion",
  "deleted_at": "2025-07-27T15:45:00.000Z",
  "final_usage": {
    "daily_usage": 25,
    "weekly_usage": 78,
    "daily_tokens_used": 4200
  }
}</div>
                                </div>
                                <div class="error-response">
                                    <div class="response-header">❌ Error Response (400)</div>
                                    <div class="response-content">{
  "success": false,
  "error": "Confirmation required",
  "message": "Please set confirm: true to delete this API key",
  "key_info": {
    "template": "text-gpt-completion",
    "description": "OpenAI GPT for text generation",
    "created_at": "2025-07-27T10:30:00.000Z",
    "usage": {
      "daily_usage": 25,
      "weekly_usage": 78,
      "daily_tokens_used": 4200
    }
  }
}</div>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">🧪 cURL Test Command</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>cURL</span>
                                    <button class="copy-btn" onclick="copyToClipboard('delete-key-curl')">Copy</button>
                                </div>
                                <div class="code-content" id="delete-key-curl">curl -X DELETE "http://localhost:3000/auth/delete-key" \
  -H "Content-Type: application/json" \
  -d '{
    "token": "eca8d79e7cf3494f",
    "template": "text-gpt-completion",
    "confirm": true
  }'</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- User Profile Route (Development Only) -->
                <div class="route-card">
                    <div class="route-header">
                        <span class="route-method">GET</span>
                        <span class="route-url">/auth/user-profile/{userId}</span>
                        <span class="badge development-only">Development Only</span>
                    </div>
                    <div class="route-body">
                        <p class="route-description">
                            Get comprehensive user profile including all API keys, session details, usage statistics, and development insights.
                        </p>

                        <div class="subsection">
                            <h4 class="subsection-title">🔄 User Flow</h4>
                            <div class="flow-step">
                                <div class="flow-step-title">1. Development Mode Check</div>
                                Ensure endpoint is only accessible in development
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">2. User Data Aggregation</div>
                                Collect session, API keys, and Redis storage data
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">3. Analytics Generation</div>
                                Calculate usage stats, insights, and summaries
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">4. Comprehensive Response</div>
                                Return detailed profile with development insights
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📤 Response Examples</h4>
                            <div class="response-container">
                                <div class="success-response">
                                    <div class="response-header">✅ Success Response (200)</div>
                                    <div class="response-content">{
  "success": true,
  "user_profile": {
    "userId": "demo3",
    "session_info": {
      "status": "active",
      "token": "eca8d79e7cf3494f",
      "session_duration_minutes": 45,
      "is_active": true
    },
    "api_keys": {
      "total_keys": 2,
      "keys": [
        {
          "template": "text-gpt-completion",
          "description": "OpenAI GPT for text generation",
          "usage_stats": {
            "daily_usage": 25,
            "weekly_usage": 78,
            "daily_tokens_used": 4200
          },
          "security": {
            "has_encrypted_key": true,
            "allowed_origins_count": 2
          }
        }
      ]
    },
    "summary": {
      "total_api_keys": 2,
      "active_session": true,
      "total_daily_usage": 25,
      "total_tokens_used_today": 4200,
      "most_used_scopes": [
        {"scope": "text", "count": 2},
        {"scope": "completion", "count": 1}
      ]
    }
  },
  "development_insights": {
    "redis_health": {
      "connection_status": true,
      "total_database_keys": 15,
      "user_data_percentage": 27
    }
  }
}</div>
                                </div>
                                <div class="error-response">
                                    <div class="response-header">❌ Error Response (403)</div>
                                    <div class="response-content">{
  "success": false,
  "error": "Endpoint only available in development mode"
}</div>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">🧪 cURL Test Command</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>cURL</span>
                                    <button class="copy-btn" onclick="copyToClipboard('user-profile-curl')">Copy</button>
                                </div>
                                <div class="code-content" id="user-profile-curl">curl -X GET "http://localhost:3000/auth/user-profile/demo3" \
  -H "Content-Type: application/json"</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- API Keys Routes -->
            <section id="api-keys" class="section">
                <h2 class="section-title">
                    🔑 API Keys Management
                </h2>

                <!-- Get My Keys -->
                <div class="route-card">
                    <div class="route-header">
                        <span class="route-method">GET</span>
                        <span class="route-url">/keys/my-keys</span>
                        <span class="badge auth-required">Bearer Token</span>
                    </div>
                    <div class="route-body">
                        <p class="route-description">
                            Retrieve all API keys for the authenticated user with usage statistics and metadata.
                        </p>

                        <div class="subsection">
                            <h4 class="subsection-title">🔄 User Flow</h4>
                            <div class="flow-step">
                                <div class="flow-step-title">1. Token Validation</div>
                                Extract and validate Bearer token from Authorization header
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">2. Fetch User Keys</div>
                                Retrieve all API keys associated with the user
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">3. Format Response</div>
                                Return keys with metadata (encrypted keys are NOT exposed)
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📋 Request Headers</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>Headers</span>
                                    <button class="copy-btn" onclick="copyToClipboard('keys-headers')">Copy</button>
                                </div>
                                <div class="code-content" id="keys-headers">Authorization: Bearer eca8d79e7cf3494f
Content-Type: application/json</div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📤 Response Examples</h4>
                            <div class="response-container">
                                <div class="success-response">
                                    <div class="response-header">✅ Success Response (200)</div>
                                    <div class="response-content">{
  "success": true,
  "userId": "demo3",
  "totalKeys": 2,
  "apiKeys": [
    {
      "template": "text-gpt-completion",
      "description": "text completion and chat using GPT models",
      "scopes": ["text", "completion", "gpt"],
      "limits": {
        "max_requests_per_day": 200,
        "max_requests_per_week": 5000,
        "max_tokens_per_day": 100000,
        "max_payload_kb": 1000
      },
      "usage": {
        "daily_usage": 15,
        "weekly_usage": 45,
        "daily_tokens_used": 3500,
        "last_reset": "2025-07-27"
      },
      "expiry_date": null,
      "allowed_origins": [],
      "created_at": "2025-07-27T14:34:03.811Z"
    }
  ]
}</div>
                                </div>
                                <div class="error-response">
                                    <div class="response-header">❌ Error Response (401)</div>
                                    <div class="response-content">{
  "success": false,
  "error": "Invalid or expired token"
}</div>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">🧪 cURL Test Command</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>cURL</span>
                                    <button class="copy-btn" onclick="copyToClipboard('my-keys-curl')">Copy</button>
                                </div>
                                <div class="code-content" id="my-keys-curl">curl -X GET "http://localhost:3000/keys/my-keys" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer eca8d79e7cf3494f"</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Proxy Routes -->
            <section id="proxy" class="section">
                <h2 class="section-title">
                    🌐 Intelligent Proxy System
                </h2>

                <!-- Main Proxy Route -->
                <div class="route-card">
                    <div class="route-header">
                        <span class="route-method">POST</span>
                        <span class="route-url">/api/proxy</span>
                        <span class="badge auth-required">Token Required</span>
                    </div>
                    <div class="route-body">
                        <p class="route-description">
                            Intelligent API routing with semantic caching, intent rewriting, access controls, and real-time analytics.
                        </p>

                        <div class="subsection">
                            <h4 class="subsection-title">🔄 Complete User Flow</h4>
                            <div class="flow-step">
                                <div class="flow-step-title">1. Token Validation</div>
                                Validate user session and extract userId
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">2. Stream Request Received</div>
                                Log request to Redis stream for real-time monitoring
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">3. Intent Rewriting (Gemini API)</div>
                                Clean and standardize user intent using AI
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">4. Semantic Cache Check</div>
                                Search for cached responses with ≥93% similarity
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">5. Template Matching</div>
                                Find best API template using vector similarity (≥75%)
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">6. Access Control Validation</div>
                                Check limits, origins, expiry, and payload size
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">7. API Key Decryption</div>
                                Decrypt stored API key for external API call
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">8. External API Call</div>
                                Forward request to target API with decrypted key
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">9. Cache & Update Usage</div>
                                Store response in cache and update usage statistics
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">10. Stream Completion</div>
                                Log completion event with metrics and return response
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📋 Request Body</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>JSON Request</span>
                                    <button class="copy-btn" onclick="copyToClipboard('proxy-request')">Copy</button>
                                </div>
                                <div class="code-content" id="proxy-request">{
  "token": "eca8d79e7cf3494f",
  "intent": "generate a creative story about AI learning to paint",
  "payload": {
    "prompt": "Write a creative story about an AI learning to paint",
    "max_tokens": 500,
    "temperature": 0.7
  },
  "origin": "https://myapp.com"
}</div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📤 Response Examples</h4>
                            <div class="response-container">
                                <div class="success-response">
                                    <div class="response-header">✅ Success Response (200)</div>
                                    <div class="response-content">{
  "response": {
    "choices": [{
      "message": {
        "role": "assistant",
        "content": "In a quiet digital realm, an AI named Canvas discovered the magic of colors..."
      }
    }],
    "usage": {"total_tokens": 145}
  },
  "matched_template": "text-gpt-completion",
  "confidence": 0.89,
  "cached": false,
  "latency_ms": 1250,
  "tokens_used": 145,
  "notices": [
    "✅ Rewritten intent: generate creative story using AI",
    "⚠️ High daily usage: 78% used"
  ]
}</div>
                                </div>
                                <div class="error-response">
                                    <div class="response-header">❌ Error Response (404)</div>
                                    <div class="response-content">{
  "success": false,
  "error": "No matching API template found for this intent",
  "suggestions": [
    {
      "template": "image-gen-dalle",
      "confidence": 0.67,
      "description": "image generation using OpenAI DALL-E API"
    },
    {
      "template": "text-gpt-completion", 
      "confidence": 0.65,
      "description": "text completion and chat using GPT models"
    }
  ]
}</div>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">🧪 cURL Test Commands</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>Gemini Text Generation</span>
                                    <button class="copy-btn" onclick="copyToClipboard('proxy-gemini-curl')">Copy</button>
                                </div>
                                <div class="code-content" id="proxy-gemini-curl">curl -X POST "http://localhost:3000/api/proxy" \
  -H "Content-Type: application/json" \
  -d '{
    "token": "eca8d79e7cf3494f",
    "intent": "generate text using Google Gemini",
    "payload": {
      "prompt": "Explain quantum computing in simple terms",
      "maxOutputTokens": 300,
      "temperature": 0.7
    },
    "origin": "https://myapp.com"
  }'</div>
                            </div>

                            <div class="code-container">
                                <div class="code-header">
                                    <span>OpenAI GPT Text Generation</span>
                                    <button class="copy-btn" onclick="copyToClipboard('proxy-gpt-curl')">Copy</button>
                                </div>
                                <div class="code-content" id="proxy-gpt-curl">curl -X POST "http://localhost:3000/api/proxy" \
  -H "Content-Type: application/json" \
  -d '{
    "token": "eca8d79e7cf3494f",
    "intent": "generate text using OpenAI GPT",
    "payload": {
      "messages": [
        {"role": "system", "content": "You are a helpful assistant."},
        {"role": "user", "content": "What is the future of AI?"}
      ],
      "model": "gpt-3.5-turbo",
      "max_tokens": 200
    },
    "origin": "https://myapp.com"
  }'</div>
                            </div>

                            <div class="code-container">
                                <div class="code-header">
                                    <span>OpenAI DALL-E Image Generation</span>
                                    <button class="copy-btn" onclick="copyToClipboard('proxy-dalle-curl')">Copy</button>
                                </div>
                                <div class="code-content" id="proxy-dalle-curl">curl -X POST "http://localhost:3000/api/proxy" \
  -H "Content-Type: application/json" \
  -d '{
    "token": "eca8d79e7cf3494f",
    "intent": "create image using DALL-E",
    "payload": {
      "prompt": "A futuristic robot painting a sunset",
      "size": "1024x1024",
      "quality": "standard",
      "style": "vivid"
    },
    "origin": "https://myapp.com"
  }'</div>
                            </div>

                            <div class="code-container">
                                <div class="code-header">
                                    <span>Anthropic Claude Chat</span>
                                    <button class="copy-btn" onclick="copyToClipboard('proxy-claude-curl')">Copy</button>
                                </div>
                                <div class="code-content" id="proxy-claude-curl">curl -X POST "http://localhost:3000/api/proxy" \
  -H "Content-Type: application/json" \
  -d '{
    "token": "eca8d79e7cf3494f",
    "intent": "generate response using Claude",
    "payload": {
      "messages": [
        {"role": "user", "content": "Explain machine learning concepts"}
      ],
      "model": "claude-3-sonnet-20240229",
      "max_tokens": 500
    },
    "origin": "https://myapp.com"
  }'</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Templates Routes -->
            <section id="templates" class="section">
                <h2 class="section-title">
                    📋 Predefined Templates Catalog
                </h2>

                <!-- Get All Templates -->
                <div class="route-card">
                    <div class="route-header">
                        <span class="route-method">GET</span>
                        <span class="route-url">/api/templates</span>
                        <span class="badge">Public</span>
                    </div>
                    <div class="route-body">
                        <p class="route-description">
                            Get a list of all available predefined API templates with their configurations.
                        </p>

                        <div class="subsection">
                            <h4 class="subsection-title">📤 Response Examples</h4>
                            <div class="response-container">
                                <div class="success-response">
                                    <div class="response-header">✅ Success Response (200)</div>
                                    <div class="response-content">{
  "success": true,
  "totalTemplates": 4,
  "categories": ["text-generation", "image-generation"],
  "providers": ["Google", "OpenAI", "Anthropic"],
  "templates": [
    {
      "id": "gemini-chat-completion",
      "name": "Google Gemini Chat Completion",
      "description": "Generate conversational AI responses using Google Gemini Pro",
      "category": "text-generation",
      "provider": "Google",
      "scopes": ["text", "chat", "completion", "gemini"],
      "pricing": {"model": "gemini-pro", "cost_per_token": 0.00025}
    }
  ]
}</div>
                                </div>
                                <div class="error-response">
                                    <div class="response-header">❌ Error Response (500)</div>
                                    <div class="response-content">{
  "success": false,
  "error": "Failed to fetch templates"
}</div>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">🧪 cURL Test Command</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>cURL</span>
                                    <button class="copy-btn" onclick="copyToClipboard('templates-curl')">Copy</button>
                                </div>
                                <div class="code-content" id="templates-curl">curl -X GET "http://localhost:3000/api/templates" \
  -H "Content-Type: application/json"</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Get Template by ID -->
                <div class="route-card">
                    <div class="route-header">
                        <span class="route-method">GET</span>
                        <span class="route-url">/api/templates/{templateId}</span>
                        <span class="badge">Public</span>
                    </div>
                    <div class="route-body">
                        <p class="route-description">
                            Get detailed configuration for a specific template including cURL commands, request/response schemas, and pricing.
                        </p>

                        <div class="subsection">
                            <h4 class="subsection-title">🧪 cURL Test Command</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>cURL</span>
                                    <button class="copy-btn" onclick="copyToClipboard('template-detail-curl')">Copy</button>
                                </div>
                                <div class="code-content" id="template-detail-curl">curl -X GET "http://localhost:3000/api/templates/gemini-chat-completion" \
  -H "Content-Type: application/json"</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Available Templates -->
                <div class="subsection">
                    <h4 class="subsection-title">🎯 Available Templates</h4>
                    <div class="template-grid">
                        <div class="template-card">
                            <div class="template-header">
                                <div class="template-name">gemini-chat-completion</div>
                                <div class="provider-badge">Google</div>
                            </div>
                            <p><strong>Description:</strong> Google Gemini Pro for conversational AI</p>
                            <p><strong>Pricing:</strong> $0.00025 per token</p>
                            <p><strong>Scopes:</strong> text, chat, completion, gemini</p>
                        </div>

                        <div class="template-card">
                            <div class="template-header">
                                <div class="template-name">openai-gpt-chat</div>
                                <div class="provider-badge">OpenAI</div>
                            </div>
                            <p><strong>Description:</strong> OpenAI GPT models for text generation</p>
                            <p><strong>Pricing:</strong> $0.002 per token</p>
                            <p><strong>Scopes:</strong> text, chat, completion, openai, gpt</p>
                        </div>

                        <div class="template-card">
                            <div class="template-header">
                                <div class="template-name">openai-dalle-image</div>
                                <div class="provider-badge">OpenAI</div>
                            </div>
                            <p><strong>Description:</strong> DALL-E for image generation from text</p>
                            <p><strong>Pricing:</strong> $0.040 per image</p>
                            <p><strong>Scopes:</strong> image, generation, dalle, openai</p>
                        </div>

                        <div class="template-card">
                            <div class="template-header">
                                <div class="template-name">anthropic-claude-chat</div>
                                <div class="provider-badge">Anthropic</div>
                            </div>
                            <p><strong>Description:</strong> Claude models for conversational AI</p>
                            <p><strong>Pricing:</strong> $0.003 per token</p>
                            <p><strong>Scopes:</strong> text, chat, completion, anthropic, claude</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Quick Start Guide -->
            <section class="section">
                <h2 class="section-title">
                    🚀 Quick Start Guide
                </h2>

                <div class="flow-step">
                    <div class="flow-step-title">Step 1: Get Demo Credentials</div>
                    <div class="code-container">
                        <div class="code-header">
                            <span>Get Demo Users</span>
                            <button class="copy-btn" onclick="copyToClipboard('quick-step1')">Copy</button>
                        </div>
                        <div class="code-content" id="quick-step1">curl -X GET "http://localhost:3000/auth/demo-users"</div>
                    </div>
                </div>

                <div class="flow-step">
                    <div class="flow-step-title">Step 2: Login & Get Token</div>
                    <div class="code-container">
                        <div class="code-header">
                            <span>Login</span>
                            <button class="copy-btn" onclick="copyToClipboard('quick-step2')">Copy</button>
                        </div>
                        <div class="code-content" id="quick-step2">curl -X POST "http://localhost:3000/auth/login" \
  -H "Content-Type: application/json" \
  -d '{"userId": "demo3", "password": "pass3"}'</div>
                    </div>
                </div>

                <div class="flow-step">
                    <div class="flow-step-title">Step 3: Add API Key</div>
                    <div class="code-container">
                        <div class="code-header">
                            <span>Add Key</span>
                            <button class="copy-btn" onclick="copyToClipboard('quick-step3')">Copy</button>
                        </div>
                        <div class="code-content" id="quick-step3">curl -X POST "http://localhost:3000/auth/add-key" \
  -H "Content-Type: application/json" \
  -d '{
    "token": "YOUR_SESSION_TOKEN",
    "api_key": "sk-your-api-key",
    "description": "My OpenAI GPT key",
    "template": "my-gpt-key",
    "scopes": ["text", "completion"]
  }'</div>
                    </div>
                </div>

                <div class="flow-step">
                    <div class="flow-step-title">Step 4: Use Proxy</div>
                    <div class="code-container">
                        <div class="code-header">
                            <span>Proxy Request</span>
                            <button class="copy-btn" onclick="copyToClipboard('quick-step4')">Copy</button>
                        </div>
                        <div class="code-content" id="quick-step4">curl -X POST "http://localhost:3000/api/proxy" \
  -H "Content-Type: application/json" \
  -d '{
    "token": "YOUR_SESSION_TOKEN",
    "intent": "generate text using AI",
    "payload": {"prompt": "Hello, world!"},
    "origin": "https://myapp.com"
  }'</div>
                    </div>
                </div>
            </section>

            <!-- Analytics Routes -->
            <section id="analytics" class="section">
                <h2 class="section-title">
                    📊 Advanced Analytics & Intelligence
                </h2>

                <!-- Vector Cache Inspector -->
                <div class="route-card">
                    <div class="route-header">
                        <span class="route-method">GET</span>
                        <span class="route-url">/api/cache-inspector</span>
                        <span class="badge auth-required">Auth Required</span>
                        <span class="badge development-only">Redis Powered</span>
                    </div>
                    <div class="route-body">
                        <p class="route-description">
                            Analyze cached embeddings with vector clustering algorithms. Provides deep insights into semantic patterns, cache efficiency, and template optimization opportunities.
                        </p>

                        <div class="subsection">
                            <h4 class="subsection-title">🔄 Analysis Flow</h4>
                            <div class="flow-step">
                                <div class="flow-step-title">1. Cache Scanning</div>
                                Scans all cached embeddings and metadata using Redis SCAN operations
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">2. Vector Clustering</div>
                                Groups similar intents using cosine similarity and clustering algorithms
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">3. Conflict Detection</div>
                                Identifies overlapping templates and redundant patterns
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">4. Performance Analysis</div>
                                Analyzes TTL effectiveness, hit rates, and storage optimization
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">🧪 cURL Test Command</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>cURL</span>
                                    <button class="copy-btn" onclick="copyToClipboard('cache-inspector-curl')">Copy</button>
                                </div>
                                <div class="code-content" id="cache-inspector-curl">curl -X GET "http://localhost:3000/api/cache-inspector?token=YOUR_TOKEN&similarity_threshold=0.8&min_cluster_size=3" \
  -H "Content-Type: application/json"</div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📤 Sample Response</h4>
                            <div class="response-container">
                                <div class="success-response">
                                    <div class="response-header">✅ Cache Analysis Results</div>
                                    <div class="response-content">{
  "success": true,
  "cache_health": {
    "overall_score": 85,
    "total_entries": 42,
    "storage_efficiency": 78
  },
  "clusters": [
    {
      "id": "cluster_0",
      "representative_intent": "generate image with AI",
      "size": 8,
      "coherence_score": 0.92
    }
  ],
  "recommendations": [
    "🎯 Consider consolidating similar templates",
    "⚡ Optimize TTL for high-frequency patterns"
  ]
}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Intent Trend Analysis -->
                <div class="route-card">
                    <div class="route-header">
                        <span class="route-method">GET</span>
                        <span class="route-url">/api/intent-trends</span>
                        <span class="badge auth-required">Auth Required</span>
                        <span class="badge development-only">AI Powered</span>
                    </div>
                    <div class="route-body">
                        <p class="route-description">
                            Analyze historical intent patterns with temporal clustering. Identifies trending topics, usage patterns, and provides predictive insights for template optimization.
                        </p>

                        <div class="subsection">
                            <h4 class="subsection-title">📋 Query Parameters</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>Parameters</span>
                                </div>
                                <div class="code-content">• token: Your session token (required)
• hours_back: Hours of history to analyze (1-168, default: 24)
• min_cluster_size: Minimum intents per cluster (2-50, default: 3)
• similarity_threshold: Clustering threshold (0.5-0.99, default: 0.8)</div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">🧪 cURL Test Command</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>cURL</span>
                                    <button class="copy-btn" onclick="copyToClipboard('intent-trends-curl')">Copy</button>
                                </div>
                                <div class="code-content" id="intent-trends-curl">curl -X GET "http://localhost:3000/api/intent-trends?token=YOUR_TOKEN&hours_back=48&min_cluster_size=3" \
  -H "Content-Type: application/json"</div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📤 Sample Response</h4>
                            <div class="response-container">
                                <div class="success-response">
                                    <div class="response-header">✅ Trend Analysis Results</div>
                                    <div class="response-content">{
  "success": true,
  "trend_analysis": {
    "total_intents": 127,
    "clusters": [
      {
        "id": "cluster_0",
        "representative_intent": "generate AI images",
        "growth_rate": 2.5,
        "popularity_score": 24
      }
    ],
    "trending_patterns": {
      "rising": ["AI image generation"],
      "declining": ["text completion"],
      "stable": ["chat responses"]
    },
    "temporal_insights": {
      "peak_hours": [10, 14, 20],
      "intent_velocity": 5.29
    }
  },
  "recommendations": [
    "📈 Rising trend: AI image generation",
    "🚀 Monitor this pattern for optimization"
  ]
}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Feedback Analytics -->
                <div class="route-card">
                    <div class="route-header">
                        <span class="route-method">GET</span>
                        <span class="route-url">/api/feedback-stats</span>
                        <span class="badge auth-required">Auth Required</span>
                    </div>
                    <div class="route-body">
                        <p class="route-description">
                            Get comprehensive analytics on user feedback, match quality ratings, and system performance metrics.
                        </p>

                        <div class="subsection">
                            <h4 class="subsection-title">🧪 cURL Test Command</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>cURL</span>
                                    <button class="copy-btn" onclick="copyToClipboard('feedback-stats-curl')">Copy</button>
                                </div>
                                <div class="code-content" id="feedback-stats-curl">curl -X GET "http://localhost:3000/api/feedback-stats?token=YOUR_TOKEN" \
  -H "Content-Type: application/json"</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Semantic Testing Playground -->
                <div class="route-card">
                    <div class="route-header">
                        <span class="route-method">POST</span>
                        <span class="route-url">/api/proxy/test</span>
                        <span class="badge auth-required">Auth Required</span>
                        <span class="badge development-only">Debug Mode</span>
                    </div>
                    <div class="route-body">
                        <p class="route-description">
                            Debug and test semantic matching algorithms in real-time. Provides detailed analysis of intent processing, vector similarity, and template matching confidence.
                        </p>

                        <div class="subsection">
                            <h4 class="subsection-title">📋 Request Body</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>JSON Request</span>
                                    <button class="copy-btn" onclick="copyToClipboard('semantic-test-request')">Copy</button>
                                </div>
                                <div class="code-content" id="semantic-test-request">{
  "token": "YOUR_SESSION_TOKEN",
  "intent": "create artistic image with AI",
  "debug_level": "detailed"
}</div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">🧪 cURL Test Command</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>cURL</span>
                                    <button class="copy-btn" onclick="copyToClipboard('semantic-test-curl')">Copy</button>
                                </div>
                                <div class="code-content" id="semantic-test-curl">curl -X POST "http://localhost:3000/api/proxy/test" \
  -H "Content-Type: application/json" \
  -d '{
    "token": "YOUR_SESSION_TOKEN",
    "intent": "create artistic image with AI",
    "debug_level": "detailed"
  }'</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Redis Features & Implementations -->
            <section id="redis-features" class="section">
                <h2 class="section-title">
                    🔴 Redis-Powered Features & Implementations
                </h2>

                <div class="route-card">
                    <div class="route-header">
                        <span class="route-method" style="background: #e74c3c;">REDIS</span>
                        <span class="route-url">Core Infrastructure</span>
                        <span class="badge" style="background: #c0392b;">Mission Critical</span>
                    </div>
                    <div class="route-body">
                        <p class="route-description">
                            KeyPilot leverages Redis as a high-performance, multi-purpose data platform powering caching, analytics, session management, and real-time intelligence features.
                        </p>

                        <div class="subsection">
                            <h4 class="subsection-title">🎯 1. Semantic Vector Cache</h4>
                            <div class="flow-step">
                                <div class="flow-step-title">Implementation</div>
                                <strong>Data Structure:</strong> Redis Hash Maps for embedding storage<br>
                                <strong>Key Pattern:</strong> <code>cache_embeddings:{userId}</code><br>
                                <strong>Value:</strong> JSON with intent, vector, confidence, timestamp<br>
                                <strong>Performance:</strong> O(1) lookup, automatic TTL management
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">Benefits</div>
                                • <strong>Lightning Fast:</strong> Sub-millisecond vector retrieval<br>
                                • <strong>Memory Efficient:</strong> Compressed embedding storage<br>
                                • <strong>Auto-Cleanup:</strong> TTL-based cache invalidation<br>
                                • <strong>Clustering:</strong> Real-time similarity analysis
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">🔐 2. Session Management & Authentication</h4>
                            <div class="flow-step">
                                <div class="flow-step-title">Implementation</div>
                                <strong>Data Structure:</strong> Redis Strings with expiration<br>
                                <strong>Key Pattern:</strong> <code>session:{token}</code><br>
                                <strong>Value:</strong> Encrypted user session data<br>
                                <strong>Security:</strong> AES-256-CTR encryption + auto-expiry
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">Benefits</div>
                                • <strong>Scalable:</strong> Stateless session storage across instances<br>
                                • <strong>Secure:</strong> Encrypted session data with TTL<br>
                                • <strong>Fast:</strong> O(1) authentication checks<br>
                                • <strong>Reliable:</strong> Automatic session cleanup
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📊 3. Intent Trend Analytics</h4>
                            <div class="flow-step">
                                <div class="flow-step-title">Implementation</div>
                                <strong>Data Structure:</strong> Redis Lists for time-series data<br>
                                <strong>Key Pattern:</strong> <code>stream:logs:{userId}</code><br>
                                <strong>Operations:</strong> LPUSH, LTRIM, LRANGE for efficient streaming<br>
                                <strong>Analysis:</strong> Vector clustering on historical data
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">Benefits</div>
                                • <strong>Time-Series:</strong> Efficient historical data storage<br>
                                • <strong>Real-time:</strong> Live streaming of intent patterns<br>
                                • <strong>Scalable:</strong> List operations with automatic trimming<br>
                                • <strong>Intelligent:</strong> ML-powered trend analysis
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">🗝️ 4. API Key Management</h4>
                            <div class="flow-step">
                                <div class="flow-step-title">Implementation</div>
                                <strong>Data Structure:</strong> Redis Hash Maps for key metadata<br>
                                <strong>Key Pattern:</strong> <code>api_keys:{userId}:{template}</code><br>
                                <strong>Value:</strong> Encrypted API keys with usage statistics<br>
                                <strong>Features:</strong> Rate limiting, retry logic, usage tracking
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">Benefits</div>
                                • <strong>Secure:</strong> Encrypted key storage with metadata<br>
                                • <strong>Organized:</strong> Hierarchical key management<br>
                                • <strong>Monitored:</strong> Usage analytics and rate limiting<br>
                                • <strong>Resilient:</strong> Built-in retry and failure handling
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📈 5. Feedback & Analytics System</h4>
                            <div class="flow-step">
                                <div class="flow-step-title">Implementation</div>
                                <strong>Data Structure:</strong> Redis Sorted Sets + Streams<br>
                                <strong>Key Pattern:</strong> <code>feedback:{userId}</code>, <code>feedback_stream</code><br>
                                <strong>Features:</strong> Real-time aggregation, rating analysis<br>
                                <strong>Analytics:</strong> Time-series feedback metrics
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">Benefits</div>
                                • <strong>Real-time:</strong> Live feedback processing<br>
                                • <strong>Aggregated:</strong> Automatic statistics calculation<br>
                                • <strong>Actionable:</strong> Quality metrics for system improvement<br>
                                • <strong>Scalable:</strong> Stream-based data processing
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">🔔 6. Notification & Event System</h4>
                            <div class="flow-step">
                                <div class="flow-step-title">Implementation</div>
                                <strong>Data Structure:</strong> Redis Pub/Sub + Lists<br>
                                <strong>Key Pattern:</strong> <code>notifications:{userId}</code><br>
                                <strong>Features:</strong> Real-time alerts, event streaming<br>
                                <strong>Use Cases:</strong> Debug notifications, system alerts
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">Benefits</div>
                                • <strong>Real-time:</strong> Instant notification delivery<br>
                                • <strong>Reliable:</strong> Persistent notification storage<br>
                                • <strong>Scalable:</strong> Pub/Sub for multiple subscribers<br>
                                • <strong>Flexible:</strong> Custom notification types and routing
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">🎯 Redis Configuration & Performance</h4>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>Current Redis Setup</span>
                                </div>
                                <div class="code-content">• Redis Version: 4.6.10+
• Connection: redis://localhost:6379
• Memory Usage: Optimized with TTL management
• Persistence: RDB + AOF for data durability
• Clustering: Single instance with backup support
• Security: Password protection + TLS ready</div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">📊 Performance Metrics</h4>
                            <div class="response-container">
                                <div class="success-response">
                                    <div class="response-header">⚡ Redis Performance Stats</div>
                                    <div class="response-content">Vector Cache Lookup: < 1ms
Session Validation: < 0.5ms
Intent Clustering: < 50ms (100 intents)
Feedback Aggregation: < 10ms
API Key Retrieval: < 1ms
Notification Delivery: < 2ms

Memory Efficiency: 85%+
Cache Hit Rate: 92%+
Data Compression: 60%+ size reduction</div>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h4 class="subsection-title">🚀 Why Redis Makes KeyPilot Powerful</h4>
                            <div class="flow-step">
                                <div class="flow-step-title">Speed & Performance</div>
                                Redis's in-memory architecture provides sub-millisecond response times for all operations, making real-time analytics and caching possible.
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">Versatility</div>
                                Multiple data structures (Hash, List, Set, Stream) allow optimal storage patterns for different use cases in a single system.
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">Scalability</div>
                                Built-in clustering, replication, and persistence ensure the system can grow with increasing load and data requirements.
                            </div>
                            <div class="flow-step">
                                <div class="flow-step-title">Intelligence</div>
                                Redis enables real-time ML operations like vector clustering and trend analysis that would be too slow with traditional databases.
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <script>
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                // Find the copy button for this element
                const container = element.closest('.code-container');
                const button = container.querySelector('.copy-btn');
                
                // Update button text temporarily
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                button.classList.add('copied');
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy text: ', err);
                alert('Failed to copy to clipboard');
            });
        }

        // Smooth scrolling for navigation links
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>
